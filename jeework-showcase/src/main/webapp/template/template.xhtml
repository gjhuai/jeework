<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:shiro="http://shiro.apache.org/tags">

<f:view contentType="text/html">
	<h:head>
		<f:facet name="first">
			<meta http-equiv="X-UA-Compatible" content="EmulateIE8" />
			<meta content='text/html; charset=UTF-8' http-equiv="Content-Type" />
			<title>欢迎使用《基础工程 V0.0.1》</title>
		</f:facet>

		<!-- CSS & JS -->
		<script type="text/javascript" src="#{request.contextPath}/template/js/jquery.easing.1.3.js" />
		<script type="text/javascript" src="#{request.contextPath}/template/js/jquery.timer.js" />
		<script type="text/javascript" src="#{request.contextPath}/template/js/jquery.tooltip.js" />
		<script type="text/javascript" src="#{request.contextPath}/template/js/main.js" />
		<link href="#{request.contextPath}/template/css/primefaces/theme.css" rel="stylesheet" type="text/css" />
		<link href="#{request.contextPath}/template/css/default.css" rel="stylesheet" type="text/css" />
		<link href="#{request.contextPath}/styles/defaultprimeface.css" rel="stylesheet" type="text/css" />
		<link href="#{request.contextPath}/styles/syntaxhighlighter.css" rel="stylesheet" type="text/css" />

		<ui:insert name="styleAndScript"></ui:insert>
	</h:head>
	<h:body>
		<div class="top" style="z-index: 3">
			<div id="top_up">
				<div id="top_up_left">
					<div id="title">
						<img height="22" src="#{request.contextPath}/images/logo_01.gif" alt="" /><span>益海嘉里《基础工程》</span>
					</div>
				</div>

				<div id="top_up_menu">
					<h:form prependId="false" id="up_menu">
						<ul>
							<c:forEach var="topMenu" items="${loginBean.allResList[1]}" varStatus="topMenuStatus">
								<c:set var="keyName" value="view:#{topMenu.keyName}"/>
								<shiro:hasPermission name="${keyName}">
									<c:if test="${sessionScope.selectId == topMenu.id}">
										<li class="top_up_menu_ul_li_B">
				                            	<p:commandLink value="#{topMenu.name}"
													action="#{loginBean.changeMenu(topMenu.id)}" ajax="false" />
										</li>
									</c:if> 
									<c:if test="${sessionScope.selectId != topMenu.id}">
										<li class="top_up_menu_ul_li_A">
				                            <p:commandLink value="#{topMenu.name}"
												action="#{loginBean.changeMenu(topMenu.id)}" ajax="false" />
										</li>
									</c:if>
								</shiro:hasPermission>									
							</c:forEach>
						</ul>
					</h:form>
				</div>
				<div id="top_up_center">
					<h:form prependId="false" id="up_center">
						<ul>
							<li>
								<img src="#{request.contextPath}/images/icons/exit.gif" />
								<h:commandLink action="#{loginBean.doLogout}">注销</h:commandLink>
							</li>
							<li><img
								src="#{request.contextPath}/images/icons/help.gif" />帮助</li>
							<li><img
								src="#{request.contextPath}/images/icons/mytable.gif" />桌面</li>
						</ul>
					</h:form>
				</div>
				<div id="top_up_right"></div>
			</div>
			<div id="top_down" style="z-index: 2">
				<div id="top_down_left">
					<h:inputHidden id="requestContextPath" value="#{request.contextPath}" />
				</div>
				<div id="top_down_center" style="z-index: 1">

					<ul id="nav">
						<c:forEach var="keyResouce" items="${loginBean.allResList[2]}" varStatus="topMenuStatus">
							<c:if test="${sessionScope.selectId==keyResouce.parentId}">
								<li>
									<c:set var="keyName" value="view:#{keyResouce.keyName}"/>
									<shiro:hasPermission name="${keyName}">
										<a id="#{keyResouce.number}" href="#">#{keyResouce.name}</a>
										<ul>
											<c:forEach var="child" items="${loginBean.allResList[3]}">
												<shiro:hasPermission name="view:${child.keyName}">
													<c:if test="#{(keyResouce.id==child.parentId) and child.ismenu}">
														<li id="#{child.number}">
															<a id="#{child.number}" href="#{request.contextPath}#{child.url}">#{child.name}</a>
														</li>
													</c:if>
												</shiro:hasPermission>
											</c:forEach>
										</ul>
									</shiro:hasPermission>
								</li>
							</c:if>
						</c:forEach>
					</ul>
				</div>
				<div id="top_down_right">
					<span class="img"> <img src="#{request.contextPath}/images/user.gif" alt="" />
					</span> <span class="fon">当前用户：<h:outputText value="#{sessionScope.userName}" />
					</span>
				</div>
			</div>			
		</div>

		<div id="main_id" class="main">
			<ui:insert name="content">
				<ui:include src="/main.xhtml" />
			</ui:insert>
		</div>
		<div class="bottom">
			<div id="down_left">
				<img src="#{request.contextPath}/images/logo_15.gif" alt="" />&copy;2011 丰益(上海)信息技术有限公司,版权所有.
			</div>

			<div id="down_right">
				<div id="down_right_time">现在时刻：</div>
				<div id="down_right_timer"></div>
				&nbsp;&nbsp;&nbsp;
			</div>
		</div>
		<p:ajaxStatus id="ajaxSubmit" onsuccess="showTooltip();">
			<f:facet name="start">
				<div class="ajaxStatus">
					<span> <h:graphicImage value="/template/img/loading.gif" /> <br /> <h:outputLabel value="数据加载中,请稍后..." />
					</span>
				</div>
			</f:facet>
			<f:facet name="complete">
				<h:outputText value="" />
			</f:facet>
		</p:ajaxStatus>
		<div id="submitDiv" style="display: none;">
			<div class="ajaxStatus">
				<span> <h:graphicImage value="/template/img/loading.gif" /> <br /> <h:outputLabel value="数据加载中,请稍后..." />
				</span>
			</div>
		</div>
	</h:body>
</f:view>
</html>